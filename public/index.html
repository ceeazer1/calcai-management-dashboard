<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalcAI - Device Management Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="calcai-logo.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Sl1sJt1n1U3YcQf7jQte2D8yL2Jw/rBP2t4H0np1T/2qJys4b1PqVbA1vT8b8tQ8w2bX8N1e5y5z2VQH7oTQRA==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <aside class="sidebar" id="sidebar">
        <div class="brand">
            <img src="calcai-logo.svg" alt="CalcAI">
            <span class="name">CalcAI</span>
        </div>
        <nav>
            <a href="#" class="active"><i class="fa-solid fa-gauge"></i><span>Dashboard</span></a>
            <a href="#firmware"><i class="fa-solid fa-microchip"></i><span>Firmware</span></a>
            <a href="#devices"><i class="fa-solid fa-tablet-screen-button"></i><span>Devices</span></a>
            <a href="#settings"><i class="fa-solid fa-gear"></i><span>Settings</span></a>
            <a href="#orders"><i class="fa-solid fa-receipt"></i><span>Orders</span></a>
        </nav>
    </aside>
    <div class="content">
        <div class="header">
            <div class="header-left">
                <button class="mobile-toggle" onclick="document.getElementById('sidebar').classList.toggle('open')">â˜°</button>
                <img src="calcai-logo.svg" alt="CalcAI Logo" class="logo">
                <h1>Device Management Dashboard</h1>
            </div>
            <div class="header-right">
                <span class="user-info">Welcome, <span id="username">Admin</span></span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
        <div class="container">
        <!-- Statistics -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalDevices">0</div>
                    <div class="stat-label">Total Devices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="onlineDevices">0</div>
                    <div class="stat-label">Online Devices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingUpdates">0</div>
                    <div class="stat-label">Pending Updates</div>
            <!-- Activity Chart -->
            <div class="section" style="height: 240px;">
                <h2>Devices Activity</h2>
                <div style="position:relative; height: 180px;">
                    <canvas id="devicesActivityChart"></canvas>
                </div>
            </div>
                </div>
            </div>

            <!-- Firmware Upload Section -->
            <div class="section" id="firmware">
                <h2>Upload New Firmware</h2>
                <div id="uploadAlert"></div>

                <div class="upload-area" id="uploadArea">
                    <p>Drag and drop a .bin file here, or click to select</p>
                    <input type="file" id="firmwareFile" accept=".bin" style="display: none;">
                </div>

                <div class="form-group">
                    <label for="firmwareVersion">Version Name:</label>
                    <input type="text" id="firmwareVersion" placeholder="e.g., v1.2.0">
                </div>

                <div class="form-group">
                    <label for="firmwareDescription">Description (optional):</label>
                    <input type="text" id="firmwareDescription" placeholder="Bug fixes and improvements">
                </div>

                <div class="progress hidden" id="uploadProgress">
                    <div class="progress-bar" id="uploadProgressBar"></div>
                </div>

                <button class="btn" onclick="uploadFirmware()">Upload Firmware</button>
            </div>

            <!-- Firmware Management Section -->
            <div class="section">
                <h2>Available Firmware Versions</h2>
                <div id="firmwareList" class="firmware-list">
                    <!-- Firmware versions will be loaded here -->
                </div>
            </div>

            <!-- Orders Section -->
            <div class="section" id="orders">
                <h2>Orders</h2>
                <div id="ordersAlert"></div>
                <div class="form-group" style="display:flex; gap:8px; flex-wrap:wrap;">
                    <input id="ordersSearch" placeholder="Search orders by ID or customer..." />
                    <select id="ordersStatus">
                        <option value="">All statuses</option>
                        <option value="processing">Processing</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                        <option value="refunded">Refunded</option>
                    </select>
                    <button class="btn" onclick="loadOrders()"><i class="fa fa-rotate"></i> Refresh</button>
                </div>
                <div class="section" style="padding:0; overflow:auto;">
                    <table style="width:100%; border-collapse:collapse;">
                        <thead>
                            <tr style="background:#1f2235;">
                                <th style="padding:12px; text-align:left; border-bottom:1px solid var(--border-color);">Order ID</th>
                                <th style="padding:12px; text-align:left; border-bottom:1px solid var(--border-color);">Date</th>
                                <th style="padding:12px; text-align:left; border-bottom:1px solid var(--border-color);">Customer</th>
                                <th style="padding:12px; text-align:left; border-bottom:1px solid var(--border-color);">Amount</th>
                                <th style="padding:12px; text-align:left; border-bottom:1px solid var(--border-color);">Status</th>
                                <th style="padding:12px; text-align:left; border-bottom:1px solid var(--border-color);">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTable">
                            <!-- Orders will be inserted here -->
                        </tbody>
                    </table>
                </div>
                <div id="orderDetails" class="section hidden">
                    <h3>Order Details</h3>
                    <div id="orderDetailsContent"></div>
                </div>
            </div>
            <!-- Device Management Section -->
            <div class="section" id="devices">
                <h2>Connected Devices</h2>
                <div style="margin-bottom: 1rem; display: flex; gap: 8px; flex-wrap: wrap;">
                    <button class="btn btn-success" onclick="refreshDevices()">Refresh Devices</button>
    <script src="charts.js"></script>
                    <button class="btn btn-danger" onclick="cancelAllUpdates()">Cancel All Updates</button>
                </div>
                <div id="deviceList" class="device-grid">
                    <!-- Devices will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script src="dashboard.js"></script>
</body>
</html>
